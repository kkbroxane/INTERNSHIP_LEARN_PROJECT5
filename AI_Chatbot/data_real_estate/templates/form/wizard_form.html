{% extends 'form/form_base.html' %}
{% load static %}
{% load widget_tweaks %}

{% block extra_links %}
  <link rel="stylesheet" href="{% static 'css/form.css' %}">
{% endblock %}

{% block content %}
<section class="p-3 p-md-4 p-xl-5" style="background-color: #001f4d;">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-12 col-md-9 col-lg-7 col-xl-6 col-xxl-5">
        <div class="card border border-light-subtle rounded-4">
          <div class="card-body p-3 p-md-4 p-xl-5">

            <div class="text-center mb-5">
              <h2 class="h4">Formulaire de bien immobilier</h2>
              <h3 class="fs-6 fw-normal text-secondary m-0">Veuillez remplir les informations ci-dessous</h3>
            </div>

            <form method="post" novalidate>
              {% csrf_token %}
              {{ wizard.management_form }}

              {% for field in wizard.form.visible_fields %}
                <div class="mb-3">

                  <!-- Champ boolÃ©en -> Select Oui / Non  -->
                  {% if field.field.is_boolean %}
                    <div class="form-floating">
                      <select name="{{ field.html_name }}" id="{{ field.id_for_label }}" class="form-select" required>
                        <option value="" disabled selected>{{ field.label }}</option>
                        <option value="True"  {% if field.value %}selected{% endif %}>Oui</option>
                        <option value="False" {% if field.value is not None and not field.value %}selected{% endif %}>Non</option>
                      </select>
                      <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                    </div>

                  <!-- Champ select normal -->
                  {% elif field.field.widget.class.name == "Select" %}
                    <div class="form-floating">
                      <select name="{{ field.html_name }}" id="{{ field.id_for_label }}" class="form-select" required>
                        <option value="" disabled selected>{{ field.label }}</option>
                        {% for val, text in field.field.choices %}
                          {% if val != "" %}
                            <option value="{{ val }}" {% if val == field.value %}selected{% endif %}>{{ text }}</option>
                          {% endif %}
                        {% endfor %}
                      </select>
                      <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                    </div>

                  <!-- Champ texte, nombre, etc. -->
                  {% else %}
                    <div class="form-floating">
                      {% render_field field class="form-control" required="required" placeholder=field.label %}
                      <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                    </div>
                  {% endif %}

                  <!-- Gestion des erreurs -->
                  {% if field.errors %}
                    <div class="text-danger small mt-1">
                      {{ field.errors|striptags }}
                    </div>
                  {% endif %}
                </div>
              {% endfor %}

              <div class="d-grid">
                <button class="btn btn-primary btn-lg" type="submit">
                  {% if wizard.steps.last %}Enregistrer{% else %}Suivant{% endif %}
                </button>
              </div>

            </form>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}
